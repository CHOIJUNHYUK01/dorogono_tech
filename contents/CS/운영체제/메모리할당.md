# 메모리 할당

프로그램에 필요한 메모리를 할당할 때, 시작 메모리 위치, 메모리 할당 크기를 기반으로 할당한다. <br />
이는 연속할당과 불연속 할당으로 나뉜다.

## 연속 할당

메모리에 "연속적으로" 공간을 할당한다. <br />
사용 가능한 모든 메모리 공간이 같은 위치에 함께 있다. <br />
즉, 메모리 파티션이 전체 메모리 공간에서 여기저기 분산되어있지 않다. <br />
이는 고정 분할 방식과 가변 분할 방식이 있다.

### 고정 분할 방식

이는 메모리를 같은 크기로 분할해서 할당하는 방법이다. <br />
이는 내부 단편화가 발생한다.

**내부 단편화**: <br />
프로그램이 필요한 공간보다 더 많은 메모리가 할당되어 내부적으로 조각이 많이 생기는 것이다. <br />
이를 통해 추후에 프로그램에 필요한 메모리를 할당하지 못하는 현상이 일어난다.

### 가변 분할 방식

프로그램에 필요한 만큼 동적으로 할당하는 방법이다. <br />
메모리를 고정된 크기 블록으로 나누지 않고, 프로그램이 필요한 만큼의 메모리를 동적으로 할당한다. <br />
프로그램이 할당된 후, 남은 공간은 새로운 가변 분할로 남겨진다. <br />
이는 이후 다른 프로그램에 할당이 가능하다. <br />
이를 통해 내부 단편화를 줄일 수 있지만, 외부 단편화가 발생할 수 있다.

**외부 단편화**: <br />
동적으로 할당하다보면, 할당한 외부에 작은 조각이 생기게 되는 현상이다. <br />
저 조각들을 합치면 50kb짜리 프로그램을 충족시킬 수 있지만, 외부의 조각들로 이뤄져 있기에, 50kb의 프로그램이 들어왔을 때 메모리를 할당하지 못할 수도 있다.

가변 분할 방식은 최초 적합, 최적 적합, 최악 적합이 있다.

- 최초 적합: <br />
  위쪽이나 아래쪽부터 시작해 홀을 찾으면 바로 할당한다.

- 최적 적합: <br />
  필요한 메모리 크기 이상인 공간 중 가장 작은 홀부터 할당한다.

- 최악 적합: <br />
  프로세스의 크기와 가장 많이 차이가 나는 홀에 할당한다.

---

## 불연속 할당

메모리를 연속적으로 할당하지 않는 방법으로, 현대 운영 체제가 쓰는 방법이다. <br />
프로그램에 필요한 메모리를 쪼개서 서로 다른 위치에 있는 메모리 공간에 할당한다. <br />
이는 대표적으로 페이징, 세그멘테이션, 페이지드 세그멘테이션 기법이 있다.

### 페이징

동일한 크기의 페이지 단위로 나눠 메모리의 서로 다른 위치에 프로세스를 할당한다. <br />
홀의 크기가 균일하지 않은 문제가 없어지지만, 주소 변환을 페이지별로 해야 하기에 주소 변환이 복잡해지는 단점이 있다.

4kb 프로세스를 2kb, 2kb 이렇게 같은 크기로 나눠 할당이 가능하기에 외부 단편화는 해결된다. <br />
하지만 내부 단편화가 생길 수 있다.

### 세그멘테이션

페이지 단위가 아닌, 의미 단위인 세그먼트로 나누는 방식이다. <br />
프로세스는 코드, 데이터, 스택, 힙으로 나눠져 메모리가 할당되는데, 코드와 데이터 또는 코드와 스택 등으로 나눌 수도 있다. <br />
그리고 함수 단위로도 나눌 수 있다. <br />
공유와 보안 측면에서 좋지만, 홀 크기가 균일하지 않게 된다. <br />
내부 단편화가 해결될 수 있지만, 외부 단편화가 일어날 수 있다.

### 페이지드 세그멘테이션

세그멘테이션으로 나누되, 해당 세그멘테이션을 동일한 크기의 페이지로 나누는 방법이다.
