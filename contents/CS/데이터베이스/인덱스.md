# 인덱스

데이터베이스 인덱스는 데이터 접근(검색, 삽입, 삭제 등) 속도를 향상하기 위해 사용되는 데이터 구조다.

## B-트리

보통의 데이터베이스에서 사용되는 인덱스 구조는 `B-트리`다. <br />
`B-트리`는 이진 검색 트리를 일반화한 자료구조다. <br />
2개 이상의 자식을 가진 노드를 허용하고, 탐색에 평균 `O(log N)`시간이 걸린다. <br />
대수 확장성이란 특징으로 인해 더 빠른 시간 안에 많은 양의 데이터를 빠르게 찾을 수 있는 구조다. <br />
`MySQL`, `PostgreSQL`, `Oracle`이 이 자료구조를 인덱스 구조로 쓴다.

### 특징

1. 모든 리프 노드들은 같은 레벨에 있다. <br />
   즉, 균형잡힌 트리를 의미한다.

2. B-트리의 차수는 노드가 가질 수 있는 자식의 최대 수를 의미한다. <br />
   예를 들어, 차수가 4인 B-트리의 경우, 각 노드는 최대 4개의 자식을 가질 수 있다.

3. B-트리는 노드 내에 여러 키를 저장하고, 각 키는 자식 노드들 사이의 값을 구분하는 역할을 한다. <br />
   예를 들어, 7과 16 사이에는 7이상 16이하의 작은 값이 들어가야 한다.

4. 노드가 꽉 찼을 때, 새로운 항목 삽입을 위해 노드를 분할한다. <br />
   반대로, 삭제로 인해 노드 사용량이 줄어들면, 인접 노드와 병합할 수 있다.

### 작동 과정

`B-트리`는 루트 노드, 브랜치 노드(내부 노드), 리프 노드로 구성된 트리다. <br />
하지만 내부 노드가 없다고 가정해서 찾는 과정을 설명하겠다.

핵심 원리는 요소들을 선형적으로 탐색하는 것이 아닌, 트리라는 자료 구조를 이용해 "있을 법한 노드"를 기반으로 찾고자 하는 요소를 빠르게 찾는 것이다.

예를 들어, `E`라는 요소를 찾는다고 했을 때, `E`가 있을 법한 노드인 2번째 노드로 가서 해당 요소를 찾는다. <br />
자료 구조 없이 `E`를 탐색하고자 하면, `A`, `B`, `C`, `D`, `E` 다섯 번을 탐색해야 하지만, 노드들로 나누면, 두 번만에 리프 노드에서 찾을 수 있는 것이다.

### 대수 확장성

`B-트리`를 아용한 인덱스가 효율적인 이유는 빠르게 `O(logN)`만에 도달할 수 있는 균형 잡힌 트리 구조라는 이유도 있지만, 대수 확장성 때문이기도 하다.

**대수 확장성**이란, 트리 깊이가 리프 노드 수에 비해 매우 느리게 성장하는 것을 의미한다. <br />
4차 `B-트리`의 경우에 기본적으로 인덱스가 한 깊이씩 증가할 때마다 최대 인덱스 항목의 수는 4배씩 증가한다. <br />
트리의 높이를 낮추기 위해 그저 자식 노드가 2개가 아니라, 보다 많은 키를 노드에 넣었다는 것이다. <br />
트리 깊이가 10개 짜리라면, 100만 개의 레코드를 검색할 수 있다는 것이다.
